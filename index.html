<!-- Trigger redeploy: updated on June 9 -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>GymFlow AI</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      text-align: center;
      margin: 0;
      padding: 2rem;
    }
    .container {
      max-width: 600px;
      margin: auto;
    }
    .pay-button {
      background-color: #4CAF50;
      color: white;
      padding: 1rem 2rem;
      text-decoration: none;
      font-size: 1.2rem;
      border-radius: 8px;
      display: inline-block;
      margin-top: 2rem;
    }
  </style>
</head>
<body>
  <div class="container">
    <h1>Welcome to GymFlow AI</h1>
    <p>Your AI-powered assistant for gyms. Automate leads, answer questions, and grow your memberships 24/7.</p>
    <a href="https://buy.stripe.com/8wM6qR3kr6eR7Q8bII" target="_blank" class="pay-button">
      Get Started â€“ $149 AUD
    </a>
  </div>

  <!-- Simple chatbot embed with mobile keyboard fix -->
<script>
  // Mobile keyboard fix
  document.addEventListener("touchstart", function (event) {
    if (
      event.target.tagName === "INPUT" ||
      event.target.tagName === "TEXTAREA" ||
      event.target.isContentEditable
    ) {
      event.target.focus();
    }
  });

  // Create chat bubble
  (function () {
    let botBubble = document.createElement('div');
    botBubble.style.position = 'fixed';
    botBubble.style.bottom = '20px';
    botBubble.style.right = '20px';
    botBubble.style.width = '60px';
    botBubble.style.height = '60px';
    botBubble.style.background = '#4CAF50';
    botBubble.style.borderRadius = '50%';
    botBubble.style.display = 'flex';
    botBubble.style.justifyContent = 'center';
    botBubble.style.alignItems = 'center';
    botBubble.style.color = '#fff';
    botBubble.style.fontSize = '30px';
    botBubble.style.cursor = 'pointer';
    botBubble.innerText = 'ðŸ’¬';

    botBubble.onclick = () => {
      let chatContainer = document.createElement('div');
      chatContainer.innerHTML = `
        <div style="position:fixed;bottom:100px;right:20px;width:300px;">
          <input id="chatInput" type="text" placeholder="Type a message..." style="width:100%;padding:10px;font-size:16px;">
        </div>`;
      document.body.appendChild(chatContainer);
      setTimeout(() => document.getElementById('chatInput').focus(), 100);
    };

    document.body.appendChild(botBubble);
  })();
</script>
  <!-- Chatbot UI and AI response handler -->
<style>
  #chatbot-box {
    position: fixed;
    bottom: 100px;
    right: 20px;
    width: 300px;
    max-height: 400px;
    overflow-y: auto;
    background: #fff;
    border: 1px solid #ccc;
    border-radius: 10px;
    padding: 10px;
    font-family: sans-serif;
    font-size: 14px;
    box-shadow: 0 0 10px rgba(0,0,0,0.2);
  }
  #chat-log {
    max-height: 300px;
    overflow-y: auto;
    margin-bottom: 10px;
  }
  #chat-log div {
    margin-bottom: 8px;
  }
  #chat-input {
    width: 100%;
    padding: 8px;
    font-size: 14px;
    box-sizing: border-box;
  }
</style>

<script>
  (function () {
    let botBubble = document.createElement('div');
    botBubble.style.position = 'fixed';
    botBubble.style.bottom = '20px';
    botBubble.style.right = '20px';
    botBubble.style.width = '60px';
    botBubble.style.height = '60px';
    botBubble.style.background = '#4CAF50';
    botBubble.style.borderRadius = '50%';
    botBubble.style.display = 'flex';
    botBubble.style.justifyContent = 'center';
    botBubble.style.alignItems = 'center';
    botBubble.style.color = '#fff';
    botBubble.style.fontSize = '30px';
    botBubble.style.cursor = 'pointer';
    botBubble.innerText = 'ðŸ’¬';

    botBubble.onclick = () => {
      if (document.getElementById('chatbot-box')) return;

      let chatContainer = document.createElement('div');
      chatContainer.id = 'chatbot-box';
      chatContainer.innerHTML = `
        <div id="chat-log"></div>
        <input id="chat-input" type="text" placeholder="Ask me anything about fitness..." />
      `;
      document.body.appendChild(chatContainer);

      const input = document.getElementById('chat-input');
      const log = document.getElementById('chat-log');

      input.focus();

      input.addEventListener('keypress', async function (e) {
        if (e.key === 'Enter') {
          const userMsg = input.value.trim();
          if (!userMsg) return;

          log.innerHTML += "<div><strong>You:</strong> " + userMsg + "</div>";
          input.value = "";
          input.disabled = true;

          try {
            const res = await fetch("/api/chat", {
              method: "POST",
              headers: { "Content-Type": "application/json" },
              body: JSON.stringify({ message: userMsg })
            });
            const data = await res.json();
            log.innerHTML += "<div><strong>GymFlow AI:</strong> ${data.reply || 'No response received. "</div>";
          } catch (err) {
            log.innerHTML += "<div><em>Error getting response. Try again.</em></div>";
          }

          input.disabled = false;
          input.focus();
          log.scrollTop = log.scrollHeight;
        }
      });
    };

    document.body.appendChild(botBubble);
  })();
</script>

</body>
</html>


